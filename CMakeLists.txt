cmake_minimum_required(VERSION 3.11 FATAL_ERROR)

project(gatling VERSION 0.1.0 LANGUAGES C)

set(CMAKE_C_STANDARD 11)
set(CMAKE_C_STANDARD_REQUIRED ON)

set(GATLING_OUTPUT_DIR "${CMAKE_BINARY_DIR}/bin" CACHE PATH "Location of build process output.")
set(GATLING_SOURCE_DIR "${PROJECT_SOURCE_DIR}/src" CACHE PATH "Location of the sources root folder.")
set(GATLING_CMAKE_DIR "${CMAKE_SOURCE_DIR}/cmake" CACHE PATH "Location of cmake scripts.")

set(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${GATLING_CMAKE_DIR}")
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY "${GATLING_OUTPUT_DIR}")
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${GATLING_OUTPUT_DIR}")
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${GATLING_OUTPUT_DIR}")

foreach(CONFIG_TYPE ${CMAKE_CONFIGURATION_TYPES})
  string(TOUPPER ${CONFIG_TYPE} CONFIG_TYPE)
  set(CMAKE_RUNTIME_OUTPUT_DIRECTORY_${CONFIG_TYPE} ${GATLING_OUTPUT_DIR})
  set(CMAKE_LIBRARY_OUTPUT_DIRECTORY_${CONFIG_TYPE} ${GATLING_OUTPUT_DIR})
  set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_${CONFIG_TYPE} ${GATLING_OUTPUT_DIR})
endforeach(CONFIG_TYPE CMAKE_CONFIGURATION_TYPES)

include(cmake/CMathLibrary.cmake)
include(cmake/ShaderLibrary.cmake)

include(CheckIPOSupported)
check_ipo_supported(RESULT ENABLE_IPO)
if (ENABLE_IPO)
  set(CMAKE_INTERPROCEDURAL_OPTIMIZATION_RELEASE ON)
endif()

add_subdirectory(extern)
add_subdirectory(src)
